# Railway Environment Variables - Setup Guide

## âš¡ MINIMÃLNÃ KONFIGURACE (povinnÃ¡)

```env
# Database - Railway PostgreSQL plugin vytvoÅ™Ã­ automaticky
DATABASE_URL=<auto-generated by Railway>

# JWT Secret - pouÅ¾ij vygenerovanÃ½ secret
JWT_SECRET=fb561332843033ad866a5de23816ae327b13fb81ebce93f719e60b3b90325a6020aadb86d86ee3deecd4b8c9ac3a5460d9d64e8d2633bc5a3ca3ee9b38b19a08

# Environment
NODE_ENV=production
```

**Jak nastavit:**
1. Railway Dashboard â†’ TvÅ¯j projekt â†’ "Variables"
2. Klikni "New Variable"
3. PÅ™idej `JWT_SECRET` s hodnotou vÃ½Å¡e
4. PÅ™idej `NODE_ENV=production`
5. DATABASE_URL se vytvoÅ™Ã­ automaticky kdyÅ¾ pÅ™idÃ¡Å¡ PostgreSQL plugin

---

skvÄ›lÃ©

## ğŸ“§ EMAIL SERVICE (volitelnÃ© - pro notifikace)

### SendGrid (DOPORUÄŒENO - free 100 emails/den)

```env
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=<tvÅ¯j SendGrid API key z https://sendgrid.com>
FROM_EMAIL=noreply@digikop.cz
```

### Gmail (jednoduÅ¡Å¡Ã­ alternativa)

```env
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=tvuj.email@gmail.com
SMTP_PASS=<app-specific password z Google Account>
FROM_EMAIL=tvuj.email@gmail.com
```

**Bez emailÅ¯:**
Aplikace funguje, jen nebude posÃ­lat notifikace. V logs uvidÃ­Å¡:
```
âš ï¸ Email service not available - notifications will be queued but not sent
```

---

## ğŸ—ºï¸ MAPBOX (povinnÃ© pro mapy)

```env
MAPBOX_ACCESS_TOKEN=<token z https://www.mapbox.com>
```

**Jak zÃ­skat:**
1. Registruj se na https://www.mapbox.com (free tier)
2. Account â†’ Access tokens â†’ Create token
3. ZkopÃ­ruj token zaÄÃ­najÃ­cÃ­ `pk.eyJ...`

âš ï¸ **Bez Mapbox tokenu mapy nebudou fungovat!**

---

## ğŸ‘¤ ADMIN ÃšÄŒET (volitelnÃ©)

```env
ADMIN_EMAIL=admin@digikop.cz
ADMIN_PASSWORD=SilneHeslo123!
```

Pokud nenastavÃ­Å¡, vytvoÅ™Ã­ se default admin:
- Email: `admin@digikop.cz`
- Password: `Admin123!`

âš ï¸ **ZMÄšÅ‡ heslo po prvnÃ­m pÅ™ihlÃ¡Å¡enÃ­!**

---

## ğŸ“¦ UPLOAD PATH (automatickÃ©)

```env
# Railway nastavÃ­ automaticky - nepÅ™idÃ¡vej manuÃ¡lnÄ›
UPLOAD_PATH=/tmp/uploads
```

Railway mÃ¡ doÄasnÃ½ filesystem, persistentnÃ­ storage Å™eÅ¡ pÅ™es S3/Cloudinary.

---

## âœ… KONTROLNÃ SEZNAM

PÅ™ed deploymentem zkontroluj v Railway Variables:

- [x] DATABASE_URL (auto-generated po pÅ™idÃ¡nÃ­ PostgreSQL)
- [x] JWT_SECRET (vygenerovanÃ½ 128-char string)
- [x] NODE_ENV=production
- [ ] MAPBOX_ACCESS_TOKEN (povinnÃ© pro mapy)
- [ ] SMTP_* promÄ›nnÃ© (pokud chceÅ¡ email notifikace)
- [ ] ADMIN_EMAIL/PASSWORD (nebo pouÅ¾ij default)

---

## ğŸ” DEBUGGING

### Zkontroluj Railway Logs:

```bash
Railway Dashboard â†’ Deployments â†’ Latest â†’ Logs
```

Hledej tyto zprÃ¡vy:

**âœ… ÃšspÄ›Å¡nÃ½ start:**
```
âœ… Configuration validated
âœ… PostGIS version: 3.x.x
âœ… All required tables created successfully
âœ… Admin user already exists
ğŸ‰ Database migration completed successfully!
ğŸš€ DigiKop server running on port 3000
```

**âŒ ChybÄ›jÃ­cÃ­ promÄ›nnÃ©:**
```
âŒ Configuration validation failed: Missing required environment variables: DATABASE_URL, JWT_SECRET
```

**âŒ PostGIS chybÃ­:**
```
âŒ Failed to enable PostGIS extension
```
â†’ Å˜eÅ¡enÃ­: PouÅ¾ij Railway PostgreSQL plugin (mÃ¡ PostGIS)

---

## ğŸš€ DEPLOY CHECKLIST

1. âœ… PÅ™idej PostgreSQL plugin v Railway
2. âœ… Nastav JWT_SECRET v Variables
3. âœ… Nastav MAPBOX_ACCESS_TOKEN v Variables
4. âœ… (VolitelnÃ©) Nastav SMTP credentials
5. âœ… Push zmÄ›ny na GitHub
6. âœ… Railway automaticky deployuje
7. âœ… ÄŒekej na "Deployment successful"
8. âœ… Otestuj: `https://your-app.railway.app/api/health`
9. âœ… PÅ™ihlaÅ¡ se jako admin
10. âœ… ZmÄ›Åˆ admin heslo!
